---
title: QuickPed - a free online pedigree creator
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{QuickPed - a free online pedigree creator}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      fig.align = "center",
                      collapse = TRUE,
                      comment = "#>")
```

::: { .greeting .message style="color: red;"}
**_Try QuickPed here_**: https://magnusdv.shinyapps.io/quickped.
:::

[QuickPed](https://magnusdv.shinyapps.io/quickped) is an interactive program for making and plotting pedigrees. After creation, the pedigree may be saved as an image, or as a text file in *ped format* (see below). You may also obtain various information about the pedigree, including coefficients of inbreeding, kinship and identity-by-descent.

QuickPed is powered by the **ped suite** and imports **kinship2** for plotting. The web app was built with Shiny.


## Using QuickPed
Creating pedigrees with QuickPed is very intuitive: Select a suitable start pedigree and modify it as needed. You may also load an existing ped file (see below). Modifications are done by clicking on one or several individuals and then applying appropriate buttons, for instance to add children, siblings or parents. At any time you may change attributes like sex, affection status, twin status and ID labels. 

## Built-in pedigrees
In the left-most panel of QuickPed the user may choose among a selection of standard pedigrees, including trios, full/half siblings, avuncular and cousin pedigrees of different kinds. Also included are several interesting (albeit less common) pedigree structures like double cousins and quad half first cousins. Finally, the following *historic pedigrees* are available:

* `Habsburg`: A subset of the infamously inbred family tree of the Habsburg royalties. The inbreeding coefficient of King Charles II of Spain (1661-1700) was approximately 0.25, i.e., equivalent to that of a child produced by full siblings. Pedigree adapted from [Wikipedia](https://en.wikipedia.org/wiki/Habsburg_family_tree). See also [The Role of Inbreeding in the Extinction of a European Royal Dynasty](https://doi.org/10.1371/journal.pone.0005174).
* `Jicaque`: A pedigree of Jicaque Indians originally studied by Chapman & Jacquard (1971) and subsequently used in many papers on relatedness and pedigree coefficients.
* `Queen Victoria (haemophilia)`: The royal family tree descending from Queen Victoria, showing the X-linked inheritance of *haemophilia*. Adapted from Figure S1 of [Genotype Analysis Identifies the Cause of the â€œRoyal Disease"](https://doi.org/10.1126/science.1180660).
* `Tutankhamun`: The family tree of the Egyptian pharao Tutankhamun, as inferred from genetic evidence presented by Hawass et al. (2010), [Ancestry and Pathology in King Tutankhamun's Family](https://doi.org/10.1001/jama.2010.121).

## Relationship information
The *Relationships* feature of QuickPed provides information about pairwise relationships within the current pedigree. After selecting any two pedigree members, the user may click either `Coeffs` or `Describe`:

* `Coeffs`: This prints a variety of pedigree coefficients describing the relationship:
  * The inbreeding coefficient of each individual (this works for any number of selected members).
  * The kinship coefficient $\varphi$.
  * The IBD coefficients $\kappa = (\kappa_0, \kappa_1, \kappa_2)$, defined as the probabilities of sharing 0, 1, and 2 alleles identical by descent (IBD). These are well-defined only if both individuals are non-inbred.
  * The 9 condensed identity coefficients of Jacquard, $\Delta = (\Delta_1, ..., \Delta_9)$.
    
  More information about these coefficients can be found in the documentation of the [ribd](https://github.com/magnusdv/ribd) package, which is used in the calculations.
  
* `Describe`: This prints a verbal description of the relationship, generated by [verbalisr](https://github.com/magnusdv/verbalisr). (NB: This is still work in progress.)

## Ped files
A useful feature of QuickPed is to produce text files describing pedigrees in so-called *ped format*. Such files are often required by software for pedigree analysis.

For a simple illustration, consider this pedigree:

```{r trio-ped, echo = F, fig.height = 1.8, fig.width = 2.2, out.width = "25%", fig.align = "center"}
df = data.frame(id = 1:3, fid = c(0,0,1), mid = c(0,0,2), sex = c(1,2,2), aff = c(1,1,2))
x = pedtools::as.ped(df[1:4])
plot(x, aff = which(df$aff == 2), margins = c(1,1,1,1))
```

A text file describing this pedigree may contain the following.

```{r, echo = F, comment = NA}
print(df, row.names = F)
```

The columns are:

* `id`: Individual ID
* `fid`: Father's ID (or 0 if not included in the pedigree)
* `mid`: Mother's ID (or 0 if not inlcuded in the pedigree)
* `sex`: Sex (1 = male; 2 = female; 0 = unknown)
* `aff`: Affection status (1 = unaffected; 2 = affected; 0 = unknown)

It should be noted that the ped format is not completely standardised, and different software may use slightly different versions. For example, a first column with *Family ID* is sometimes required. Also, the `aff` column may not be needed in non-medical applications. These and other details may be specified when using QuickPed.

Some pedigree information may be shown on the plot, but is *not* stored in the ped file. In the current version of QuickPed, this includes twin relationships, and also `deceased` status.
